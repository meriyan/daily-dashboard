<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MaryV</title>
  <link rel="manifest" href="/manifest.json" />
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js');
      });
    }
  </script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 0;
    }
    .tabs {
      display: flex;
      justify-content: center;
      background-color: #007bff;
      flex-wrap: wrap;
    }
    .tab {
      padding: 15px 20px;
      color: white;
      cursor: pointer;
    }
    .tab.active {
      background-color: #0056b3;
    }
    .content {
      padding: 30px;
      max-width: 700px;
      margin: auto;
    }
    h1 {
      text-align: center;
    }
    #currentDate {
      text-align: center;
      font-weight: bold;
      margin-bottom: 20px;
    }
    .todo-container {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    input[type="text"], input[type="time"], input[type="date"], input[type="number"] {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    button {
      padding: 10px 15px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 5px;
    }
    ul {
      list-style-type: none;
      padding-left: 0;
      margin-top: 15px;
    }
    li {
      background: #eee;
      padding: 10px;
      margin-bottom: 8px;
      border-radius: 5px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .task-group {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-grow: 1;
    }
    .completed .task-text {
      text-decoration: line-through;
      color: gray;
    }
    .task-text {
      font-size: 16px;
    }
    .remove-btn {
      background: red;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
    }
    input[type="checkbox"] {
      transform: scale(1.2);
    }
    .hidden {
      display: none;
    }
    .log-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }
    summary {
      cursor: pointer;
      font-weight: bold;
      margin-top: 10px;
    }
  </style>
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-database-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBnXWDkKRsbjvdgMlSrbgJvssu9N-LUDuA",
      authDomain: "dailydashboard-64139.firebaseapp.com",
      databaseURL: "https://dailydashboard-64139-default-rtdb.firebaseio.com",
      projectId: "dailydashboard-64139",
      storageBucket: "dailydashboard-64139.firebasestorage.app",
      messagingSenderId: "420557412452",
      appId: "1:420557412452:web:8ee806a83543b2b1776771"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
  </script>
</head>
<body>
  <div class="tabs">
    <div class="tab active" data-tab="todo">‚úÖ To-Do List</div>
    <div class="tab" data-tab="timelog">‚è±Ô∏è Time Log</div>
    <div class="tab" data-tab="social">üì± Social Tracker</div>
    <div class="tab" data-tab="hair">üíá Hair Tracker</div>
    <div class="tab" data-tab="sleep">üí§ Sleep Tracker</div>
  </div>
  <div class="content">
    <div id="currentDate"></div>

    <div id="todo" class="todo-container">
      <h1>To-Do List</h1>
      <input type="text" id="taskInput" placeholder="Write your task..." />
      <button onclick="addTask()">Add</button>
      <div id="dailyTaskSections"></div>
    </div>

    <div id="timelog" class="todo-container hidden">
      <h1>Time Log</h1>
      <input type="time" id="timeStart" />
      <input type="time" id="timeEnd" />
      <input type="text" id="activityDesc" placeholder="What did you do?" />
      <button onclick="addTimeLog()">Save</button>
      <ul id="timeLogList"></ul>
    </div>

    <div id="social" class="todo-container hidden">
      <h1>Social Tracker</h1>
      <input type="text" id="socialActivity" placeholder="What social app did you use?" />
      <button onclick="addSocialLog()">Log</button>
      <ul id="socialList"></ul>
    </div>

    <div id="hair" class="todo-container hidden">
      <h1>Hair Tracker</h1>
      <button onclick="logHairTouch()">I touched my hair</button>
      <ul id="hairLogList"></ul>
    </div>

    <div id="sleep" class="todo-container hidden">
      <h1>Sleep Tracker</h1>
      <input type="time" id="sleepStart" />
      <input type="time" id="sleepEnd" />
      <button onclick="logSleep()">Log Sleep</button>
      <ul id="sleepLogList"></ul>
    </div>
  </div>

  <script>
    const taskInput = document.getElementById("taskInput");
    const dateKey = new Date().toISOString().split("T")[0];
    document.getElementById("currentDate").textContent = "üìÖ " + new Date().toLocaleDateString();

    async function getStoredTasks() {
      const snapshot = await db.ref("tasks").get();
      return snapshot.exists() ? snapshot.val() : {};
    }

    function storeTasks(tasks) {
      db.ref("tasks").set(tasks);
    }

    async function addTask(text = "", done = false, date = dateKey) {
      const tasks = await getStoredTasks();
      tasks[date] = tasks[date] || [];
      const taskText = text || taskInput.value.trim();
      if (!taskText) return;
      tasks[date].push({ text: taskText, done });
      storeTasks(tasks);
      taskInput.value = "";
      renderTasks(tasks);
    }

    async function toggleDone(date, index) {
      const tasks = await getStoredTasks();
      tasks[date][index].done = !tasks[date][index].done;
      storeTasks(tasks);
      renderTasks(tasks);
    }

    async function deleteTask(date, index) {
      const tasks = await getStoredTasks();
      tasks[date].splice(index, 1);
      storeTasks(tasks);
      renderTasks(tasks);
    }

    function renderTasks(tasksData = null) {
      const container = document.getElementById("dailyTaskSections");
      container.innerHTML = "";
      const tasks = tasksData || {};
      Object.keys(tasks).sort((a,b) => b.localeCompare(a)).forEach(date => {
        const details = document.createElement("details");
        if (date === dateKey) details.setAttribute("open", true);
        const summary = document.createElement("summary");
        summary.textContent = `Tasks for ${new Date(date).toLocaleDateString()}`;
        const ul = document.createElement("ul");
        tasks[date].forEach((task, i) => {
          const li = document.createElement("li");
          if (task.done) li.classList.add("completed");
          const group = document.createElement("div");
          group.className = "task-group";
          const checkbox = document.createElement("input");
          checkbox.type = "checkbox";
          checkbox.checked = task.done;
          checkbox.onchange = () => toggleDone(date, i);
          const span = document.createElement("span");
          span.className = "task-text";
          span.textContent = task.text;
          const del = document.createElement("button");
          del.textContent = "üóëÔ∏è";
          del.className = "remove-btn";
          del.onclick = () => deleteTask(date, i);
          group.appendChild(checkbox);
          group.appendChild(span);
          li.appendChild(group);
          li.appendChild(del);
          ul.appendChild(li);
        });
        details.appendChild(summary);
        details.appendChild(ul);
        container.appendChild(details);
      });
    }

    function switchTab(tabName) {
      document.querySelectorAll(".tab").forEach(tab => {
        tab.classList.toggle("active", tab.dataset.tab === tabName);
      });
      const sections = ["todo", "timelog", "social", "hair", "sleep"];
      sections.forEach(id => {
        document.getElementById(id).classList.toggle("hidden", id !== tabName);
      });
    }

    function addTimeLog() {
      const start = document.getElementById("timeStart").value;
      const end = document.getElementById("timeEnd").value;
      const desc = document.getElementById("activityDesc").value;
      if (!start || !end || !desc) return;

      const li = document.createElement("li");
      li.textContent = `${start} - ${end}: ${desc}`;
      document.getElementById("timeLogList").appendChild(li);

      document.getElementById("timeStart").value = "";
      document.getElementById("timeEnd").value = "";
      document.getElementById("activityDesc").value = "";
    }

    function addSocialLog() {
      const app = document.getElementById("socialActivity").value.trim();
      if (!app) return;
      const li = document.createElement("li");
      li.textContent = `${new Date().toLocaleTimeString()}: ${app}`;
      document.getElementById("socialList").appendChild(li);
      document.getElementById("socialActivity").value = "";
    }

    function logHairTouch() {
      const li = document.createElement("li");
      li.textContent = `Touched at ${new Date().toLocaleTimeString()}`;
      document.getElementById("hairLogList").appendChild(li);
    }

    function logSleep() {
      const start = document.getElementById("sleepStart").value;
      const end = document.getElementById("sleepEnd").value;
      if (!start || !end) return;
      const li = document.createElement("li");
      li.textContent = `Slept from ${start} to ${end}`;
      document.getElementById("sleepLogList").appendChild(li);
      document.getElementById("sleepStart").value = "";
      document.getElementById("sleepEnd").value = "";
    }

    window.onload = async () => {
      const tasks = await getStoredTasks();
      renderTasks(tasks);
      document.querySelectorAll(".tab").forEach(tab => {
        tab.addEventListener("click", () => {
          switchTab(tab.dataset.tab);
        });
      });
    };
  </script>
</body>
</html>
